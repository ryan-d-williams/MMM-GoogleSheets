{% import "macros.njk" as macros %}

<div class="wrapper gs-cellstyle-{{ config.cellStyle }}">
  {% if anyErrors %}
    {% if paramErrors %}
      {% for parameter, isError in errors %}
        {% if isError %}
          <div class="dimmed light small">Missing required parameter: {{parameter}}</div>
        {% endif %}
      {% endfor %}
    {% elif runtimeErrors %}
      <div class="dimmed light small">There was an error in the request: {{runtimeErrorMsg}}</div>
    {% endif %}
  {% elif loading %}
    <div class="dimmed light small">{{ phrases.loading | safe }}</div>
  {% else %}
    <div class="table-wrapper">
      <table class="sheets-table">
        {% for row in sheetData %}
          {% set rowIndex = loop.index0 %}
          <tr class="sheets-table-row">
            {% for cell in row %}
              {% set colIndex = loop.index0 %}
              {% if cell.merge %}
                <td class="small sheets-table-cell" style="{{cell.style}}" colspan="{{cell.merge_data.colspan}}" rowspan="{{cell.merge_data.rowspan}}">
                  {{ macros.renderCell(cell, rowIndex, colIndex) }}
                </td>
              {% elif cell.display %}
                <td class="small sheets-table-cell" style="{{cell.style}}">
                  {{ macros.renderCell(cell, rowIndex, colIndex) }}
                </td>
              {% endif %}
            {% endfor %}
          </tr>
        {% endfor %}
      </table>
    </div>
  {% endif %}
</div>
